<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Testing | Package Development in R for Predator Free New Zealand 2050</title>
  <meta name="description" content="This guide walks through the process of developing an R package" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Testing | Package Development in R for Predator Free New Zealand 2050" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This guide walks through the process of developing an R package" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Testing | Package Development in R for Predator Free New Zealand 2050" />
  
  <meta name="twitter:description" content="This guide walks through the process of developing an R package" />
  

<meta name="author" content="Anthony Davidson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="package-development.html"/>
<link rel="next" href="documentation.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An R package development tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#table-of-contents"><i class="fa fa-check"></i>Table of Contents</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors-and-sources"><i class="fa fa-check"></i>Authors and Sources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="package-development.html"><a href="package-development.html"><i class="fa fa-check"></i><b>1</b> Package Development</a>
<ul>
<li class="chapter" data-level="1.1" data-path="package-development.html"><a href="package-development.html#downloading-development-tools"><i class="fa fa-check"></i><b>1.1</b> Downloading Development Tools</a></li>
<li class="chapter" data-level="1.2" data-path="package-development.html"><a href="package-development.html#initializing-the-package"><i class="fa fa-check"></i><b>1.2</b> Initializing the Package</a></li>
<li class="chapter" data-level="1.3" data-path="package-development.html"><a href="package-development.html#file-paths"><i class="fa fa-check"></i><b>1.3</b> File Paths</a></li>
<li class="chapter" data-level="1.4" data-path="package-development.html"><a href="package-development.html#the-description"><i class="fa fa-check"></i><b>1.4</b> The DESCRIPTION</a></li>
<li class="chapter" data-level="1.5" data-path="package-development.html"><a href="package-development.html#writing-code"><i class="fa fa-check"></i><b>1.5</b> Writing Code</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="package-development.html"><a href="package-development.html#general-coding-guidelines"><i class="fa fa-check"></i><b>1.5.1</b> General Coding Guidelines</a></li>
<li class="chapter" data-level="1.5.2" data-path="package-development.html"><a href="package-development.html#code-style"><i class="fa fa-check"></i><b>1.5.2</b> Code Style</a></li>
<li class="chapter" data-level="1.5.3" data-path="package-development.html"><a href="package-development.html#warnings-and-simplicity"><i class="fa fa-check"></i><b>1.5.3</b> Warnings and Simplicity</a></li>
<li class="chapter" data-level="1.5.4" data-path="package-development.html"><a href="package-development.html#loading-your-code"><i class="fa fa-check"></i><b>1.5.4</b> Loading Your Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="testing.html"><a href="testing.html"><i class="fa fa-check"></i><b>2</b> Testing</a>
<ul>
<li class="chapter" data-level="2.1" data-path="testing.html"><a href="testing.html#why-should-you-test"><i class="fa fa-check"></i><b>2.1</b> Why should you test?</a></li>
<li class="chapter" data-level="2.2" data-path="testing.html"><a href="testing.html#what-are-unit-tests"><i class="fa fa-check"></i><b>2.2</b> What are unit tests?</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="testing.html"><a href="testing.html#setting-up-the-testing-environment"><i class="fa fa-check"></i><b>2.2.1</b> Setting up the testing environment</a></li>
<li class="chapter" data-level="2.2.2" data-path="testing.html"><a href="testing.html#expectations"><i class="fa fa-check"></i><b>2.2.2</b> Expectations</a></li>
<li class="chapter" data-level="2.2.3" data-path="testing.html"><a href="testing.html#structure-and-location-of-unit-tests"><i class="fa fa-check"></i><b>2.2.3</b> Structure and Location of Unit Tests</a></li>
<li class="chapter" data-level="2.2.4" data-path="testing.html"><a href="testing.html#writing-good-tests"><i class="fa fa-check"></i><b>2.2.4</b> Writing Good Tests</a></li>
<li class="chapter" data-level="2.2.5" data-path="testing.html"><a href="testing.html#automated-checking"><i class="fa fa-check"></i><b>2.2.5</b> Automated Checking</a></li>
<li class="chapter" data-level="2.2.6" data-path="testing.html"><a href="testing.html#bonus-the-goodpractice-package"><i class="fa fa-check"></i><b>2.2.6</b> Bonus: The goodpractice Package</a></li>
<li class="chapter" data-level="2.2.7" data-path="testing.html"><a href="testing.html#tips-and-tricks"><i class="fa fa-check"></i><b>2.2.7</b> Tips and Tricks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="documentation.html"><a href="documentation.html"><i class="fa fa-check"></i><b>3</b> Documentation</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="documentation.html"><a href="documentation.html#documenting-functions"><i class="fa fa-check"></i><b>3.0.1</b> Documenting Functions</a></li>
<li class="chapter" data-level="3.0.2" data-path="documentation.html"><a href="documentation.html#adding-a-readme"><i class="fa fa-check"></i><b>3.0.2</b> Adding a README</a></li>
<li class="chapter" data-level="3.1" data-path="documentation.html"><a href="documentation.html#vignettes"><i class="fa fa-check"></i><b>3.1</b> Vignettes</a></li>
<li class="chapter" data-level="3.2" data-path="documentation.html"><a href="documentation.html#adding-and-documenting-data"><i class="fa fa-check"></i><b>3.2</b> Adding and Documenting Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="documentation.html"><a href="documentation.html#including-data-which-should-be-available-to-users"><i class="fa fa-check"></i><b>3.2.1</b> Including data which should be available to users</a></li>
<li class="chapter" data-level="3.2.2" data-path="documentation.html"><a href="documentation.html#including-data-for-your-functions"><i class="fa fa-check"></i><b>3.2.2</b> Including data for your functions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="documentation.html"><a href="documentation.html#releasing-your-package"><i class="fa fa-check"></i><b>3.3</b> Releasing Your Package</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="documentation.html"><a href="documentation.html#pushing-to-github"><i class="fa fa-check"></i><b>3.3.1</b> Pushing to GitHub</a></li>
<li class="chapter" data-level="3.3.2" data-path="documentation.html"><a href="documentation.html#cran"><i class="fa fa-check"></i><b>3.3.2</b> CRAN</a></li>
<li class="chapter" data-level="3.3.3" data-path="documentation.html"><a href="documentation.html#publicizing"><i class="fa fa-check"></i><b>3.3.3</b> Publicizing</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="documentation.html"><a href="documentation.html#tips-and-tricks-1"><i class="fa fa-check"></i><b>3.4</b> Tips and Tricks</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>4</b> Resources</a>
<ul>
<li class="chapter" data-level="4.1" data-path="resources.html"><a href="resources.html#general"><i class="fa fa-check"></i><b>4.1</b> General</a></li>
<li class="chapter" data-level="4.2" data-path="resources.html"><a href="resources.html#package-development-1"><i class="fa fa-check"></i><b>4.2</b> Package Development</a></li>
<li class="chapter" data-level="4.3" data-path="resources.html"><a href="resources.html#version-control"><i class="fa fa-check"></i><b>4.3</b> Version Control</a></li>
<li class="chapter" data-level="4.4" data-path="resources.html"><a href="resources.html#ides"><i class="fa fa-check"></i><b>4.4</b> IDEs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Package Development in R for Predator Free New Zealand 2050</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="testing" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Testing</h1>
<div id="why-should-you-test" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Why should you test?</h2>
<p>Suppose an imaginary programmer named Grace has created a package and has been using it for a while, but she decides she’d like to modify one function to improve it. She modifies her function, tests it a bit, and then publishes a new version of the package. Yet two weeks later, another imaginary programmer named Carlos discovers that the changes she made created a bug in <em>another</em> function in the package! This situation is very annoying, especially if Carlos has no idea what has caused the bug or how to fix it. Unfortunately, it’s also an extremely common problem.</p>
<p>The solution to problems like this is to test your package <em>systematically</em> and <em>automatically</em>. If Grace had rigorously tested the entire package before publishing it, Carlos would never have had to deal with the new bug- Grace would have found out immediately. In other words, a good principle in package development is to make sure your code <em>fails as fast as possible,</em> so you can find out and fix it. Of course, all programmers test their code, but not everyone tests systematically and automatically.</p>
</div>
<div id="what-are-unit-tests" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> What are unit tests?</h2>
<p>Tests compare the <em>expected</em> output of a block of code to its <em>actual</em> output. For example, the following test tests whether the “generalized square root” function actually returns <span class="math inline">\(2\)</span> as the square root of <span class="math inline">\(4\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="testing.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">general_sqrt</span>(<span class="dv">4</span>), <span class="fu">complex</span>(<span class="at">real =</span> <span class="dv">2</span>, <span class="at">imaginary =</span> <span class="dv">0</span>))</span></code></pre></div>
<p><em>Unit tests</em> usually run on the computer of the developer who is modifying a package and also should run automatically upon building a package.</p>
<p>We’ll talk a little more about how exactly to create tests below, but hopefully this makes the general concept clear (you’ve also probably been using the general concept as you program).</p>
<div id="setting-up-the-testing-environment" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Setting up the testing environment</h3>
<p>Creating unit tests is actually quite easy, thanks to a package called <code>testthat</code> which works in combination with <code>usethis</code>. To begin, you should run the following command in your favorite IDE, or even in the R Gui:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="testing.html#cb2-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_testthat</span>()</span></code></pre></div>
<p>This will do a couple of things. First, it will add <code>testthat</code> to the Suggests part of the DESCRIPTION, which will help other collaborators know to use <code>testthat</code> when modifying/working on the package. It will also create a ‘tests/testthat’ directory in your project, as well a file called ‘test/testthat.R’, as shown below.</p>
<p><img src="images/testSS/devtoolstestthat.PNG" /></p>
</div>
<div id="expectations" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Expectations</h3>
<p>Before discussing how to write unit tests, we need to properly describe an expectation. An expectation tests whether the actual output of a single function call is what the developer expected. The <code>testthat</code> package has a number of functions which compare outputs to expected values. When calling one of these functions, one of two things can happen:</p>
<ol style="list-style-type: decimal">
<li>If the actual output matches the expectation, nothing will happen!</li>
<li>If the actual output does not match the expectation, it will throw an error.</li>
</ol>
<p>For example, <code>expect_equal()</code> uses the base R function <code>all.equal()</code> to check whether an output is (approximately) equal to an expectation. In the following code, the first function call will do nothing - the second function call will throw an error, displayed below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="testing.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(testthat)</span>
<span id="cb3-2"><a href="testing.html#cb3-2" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb3-3"><a href="testing.html#cb3-3" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="dv">2</span>, <span class="dv">4</span>)</span></code></pre></div>
<p><img src="images/testSS/expectationerror.PNG" /></p>
<p>Here’s an (abbreviated) list of the expectation functions:</p>
<ol style="list-style-type: decimal">
<li><strong>expect_equal</strong>, as aforementioned, checks equality using the “all.equal()” base function.</li>
<li><strong>expect_identical</strong> checks equality using the <code>identical()</code> base function. Generally, it’s better to use <code>expect_equal()</code> because lots of R functions use numerical approximations which will cause expect_identical to fail when you don’t want it to.</li>
<li><strong>expect_match</strong>, <strong>expect_output</strong>, <strong>expect_message</strong>, <strong>expect_warning</strong>, and <strong>expect_error</strong> all respectively test whether a string, output, warning, or error match a regular expression. For example, the following two expectations functions will not throw errors:</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="testing.html#cb4-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_match</span>(<span class="st">&#39;hello1234&#39;</span>, <span class="st">&#39;hello&#39;</span>)</span>
<span id="cb4-2"><a href="testing.html#cb4-2" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span>), <span class="st">&#39;NaNs produced&#39;</span>)</span></code></pre></div>
<p>The tests do not fail because (i) ‘hello1234’ contains ‘hello’ and (ii) the error message produced by <code>sqrt(-2)</code> contains the phrase ‘NaNs produced’.</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>expect_is</strong> tests whether an object inherits from a class, specified in quotes. For example, the following test passes:</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="testing.html#cb5-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_is</span>(<span class="fu">sqrt</span>(<span class="dv">2</span>), <span class="st">&#39;numeric&#39;</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li><strong>expect_true</strong> and <strong>expect_false</strong> respectively expect a statement to evaluate to TRUE or FALSE.</li>
</ol>
</div>
<div id="structure-and-location-of-unit-tests" class="section level3" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Structure and Location of Unit Tests</h3>
<p>Each <em>unit test</em> (which is written in an R script) should use a couple of expectations to test a single core function. It should use the function <code>test_that()</code> (from the <code>testthat</code> package). <code>test_that()</code> takes two parameters: a string, which describes the test, and a couple of expectations, surrounded by curly braces. For example, the following code will test whether the <code>general_sqrt()</code> function from the <code>devex</code> package returns a complex number.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="testing.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;Returns complex number&quot;</span>, {</span>
<span id="cb6-2"><a href="testing.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_is</span>(<span class="fu">general_sqrt</span>(<span class="sc">-</span><span class="dv">2</span>), <span class="st">&#39;complex&#39;</span>)</span>
<span id="cb6-3"><a href="testing.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_is</span>(<span class="fu">general_sqrt</span>(<span class="dv">2</span>), <span class="st">&#39;complex&#39;</span>)</span>
<span id="cb6-4"><a href="testing.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_is</span>(<span class="fu">general_sqrt</span>(<span class="dv">0</span>), <span class="st">&#39;complex&#39;</span>)</span>
<span id="cb6-5"><a href="testing.html#cb6-5" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Multiple tests with similar functions should be put in the same file, and those test files must be put in the tests/testthat/ directory. Moreover, their name must start with the word ‘test’ - this will help R automatically run your tests for you. For example, in the <code>devex</code> package, there are two very simple helper functions (<code>general_sqrt()</code> and <code>loss()</code>) and one moderately complex function (<code>scalep()</code>). As a result, the <code>devex</code> package has exactly two testing files: one called ‘testhelpers’, which tests the helper functions, and another called ‘testscalep’, which tests the <code>scalep()</code> function. The ‘testhelpers’ file looks like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="testing.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devex)</span>
<span id="cb7-2"><a href="testing.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">context</span>(<span class="st">&quot;generalized sqrt and loss&quot;</span>)</span>
<span id="cb7-3"><a href="testing.html#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="testing.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generalized sqrt ---------------------------------------</span></span>
<span id="cb7-5"><a href="testing.html#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="testing.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;Returns complex number&quot;</span>, {</span>
<span id="cb7-7"><a href="testing.html#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_is</span>(<span class="fu">general_sqrt</span>(<span class="sc">-</span><span class="dv">2</span>), <span class="st">&#39;complex&#39;</span>)</span>
<span id="cb7-8"><a href="testing.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_is</span>(<span class="fu">general_sqrt</span>(<span class="dv">2</span>), <span class="st">&#39;complex&#39;</span>)</span>
<span id="cb7-9"><a href="testing.html#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_is</span>(<span class="fu">general_sqrt</span>(<span class="dv">0</span>), <span class="st">&#39;complex&#39;</span>)</span>
<span id="cb7-10"><a href="testing.html#cb7-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-11"><a href="testing.html#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="testing.html#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;Returns correct sqrt&quot;</span>, {</span>
<span id="cb7-13"><a href="testing.html#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">general_sqrt</span>(<span class="sc">-</span><span class="fl">1.53</span>), <span class="fu">complex</span>(<span class="at">real =</span> <span class="dv">0</span>, <span class="at">imaginary =</span> <span class="fu">sqrt</span>(<span class="fl">1.53</span>)))</span>
<span id="cb7-14"><a href="testing.html#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">general_sqrt</span>(<span class="sc">-</span><span class="dv">2</span>), <span class="fu">complex</span>(<span class="at">real =</span> <span class="dv">0</span>, <span class="at">imaginary =</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)))</span>
<span id="cb7-15"><a href="testing.html#cb7-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-16"><a href="testing.html#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="testing.html#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;Warnings for vectors of length &gt; 1&quot;</span>, {</span>
<span id="cb7-18"><a href="testing.html#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_warning</span>(<span class="fu">general_sqrt</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>)))</span>
<span id="cb7-19"><a href="testing.html#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_warning</span>(<span class="fu">general_sqrt</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>)), <span class="st">&#39;NaNs produced&#39;</span>)</span>
<span id="cb7-20"><a href="testing.html#cb7-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-21"><a href="testing.html#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="testing.html#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Loss ---------------------------------------------------</span></span>
<span id="cb7-23"><a href="testing.html#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="testing.html#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;Returns correct loss&quot;</span>, {</span>
<span id="cb7-25"><a href="testing.html#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">loss</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dv">9</span>)</span>
<span id="cb7-26"><a href="testing.html#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">loss</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb7-27"><a href="testing.html#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">loss</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">25</span>, <span class="dv">4</span>))</span>
<span id="cb7-28"><a href="testing.html#cb7-28" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Each test file, as demonstrated above, needs to load the package of interest (using <code>library()</code> is fine) and also should supply a string which succinctly describes the general purpose of all of the tests in the test file to the <code>context()</code> function.</p>
<p>You can run all of the tests in the test/testthat directory by running the following <code>devtools</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="testing.html#cb8-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">test</span>()</span></code></pre></div>
<p>If any test throws an error, R will report two things. First, it will report the string given in the test which was given to the <code>test_that()</code> function call. Second, it will report the filename of the test file as well as the line of code that threw an error. For example, running the above tests yields the following result:</p>
<p><img src="images/testSS/testthaterror1.PNG" /></p>
<p>This indicates that line 18 of testhelpers.R failed in the test “Warnings for vectors of length &gt; 1.” Looking at the test code reveals that the <code>general_sqrt()</code> function does not return a warning for positive vectors of length greater than one.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="testing.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expect_warning</span>(<span class="fu">general_sqrt</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>)))</span></code></pre></div>
<p>To fix this, it might be worth adding in an extra line or two which ensures that the input to <code>general_sqrt()</code> is as it should be (to prevent users from getting unexpected results).</p>
</div>
<div id="writing-good-tests" class="section level3" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Writing Good Tests</h3>
<p>Good tests have a couple of characteristics.</p>
<p><strong>First</strong>, good tests have high <em>coverage,</em> meaning that they test a large percentage of the lines of code of the package. For example, the code for the <code>general_sqrt()</code> function is as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="testing.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This function takes the complex square root of real numbers</span></span>
<span id="cb10-2"><a href="testing.html#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="testing.html#cb10-3" aria-hidden="true" tabindex="-1"></a>general_sqrt <span class="ot">&lt;-</span> <span class="cf">function</span> (x){</span>
<span id="cb10-4"><a href="testing.html#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="testing.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Issue warning for longer vectors</span></span>
<span id="cb10-6"><a href="testing.html#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb10-7"><a href="testing.html#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">&#39;Argument of general_sqrt has length greater than 1&#39;</span>)</span>
<span id="cb10-8"><a href="testing.html#cb10-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-9"><a href="testing.html#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="testing.html#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the normal square root if x &gt; 0</span></span>
<span id="cb10-11"><a href="testing.html#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">||</span> x <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb10-12"><a href="testing.html#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">complex</span>(<span class="at">real =</span> <span class="fu">sqrt</span>(x), <span class="at">imaginary =</span> <span class="dv">0</span>))</span>
<span id="cb10-13"><a href="testing.html#cb10-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-14"><a href="testing.html#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="testing.html#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Else return the complex square root</span></span>
<span id="cb10-16"><a href="testing.html#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="testing.html#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb10-18"><a href="testing.html#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">complex</span>(<span class="at">real =</span> <span class="dv">0</span>, <span class="at">imaginary =</span> <span class="fu">sqrt</span>(<span class="sc">-</span>x)))</span>
<span id="cb10-19"><a href="testing.html#cb10-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-20"><a href="testing.html#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="testing.html#cb10-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The following test has low coverage for the <code>general_sqrt()</code> function:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="testing.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;Returns correct sqrt&quot;</span>, {</span>
<span id="cb11-2"><a href="testing.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">general_sqrt</span>(<span class="sc">-</span><span class="fl">1.53</span>), <span class="fu">complex</span>(<span class="at">real =</span> <span class="dv">0</span>, <span class="at">imaginary =</span> <span class="fu">sqrt</span>(<span class="fl">1.53</span>)))</span>
<span id="cb11-3"><a href="testing.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">general_sqrt</span>(<span class="sc">-</span><span class="dv">2</span>), <span class="fu">complex</span>(<span class="at">real =</span> <span class="dv">0</span>, <span class="at">imaginary =</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)))</span>
<span id="cb11-4"><a href="testing.html#cb11-4" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>because it only tests whether <code>general_sqrt()</code> returns the correct square root for negative numbers. This test thus only covers half of the code in <code>general_sqrt()</code>, because the mechanism for dealing with nonnegative numbers is entirely separate. The following test is a better example, because it tests both positive and negative numbers.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="testing.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;Returns correct sqrt&quot;</span>, {</span>
<span id="cb12-2"><a href="testing.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">general_sqrt</span>(<span class="fl">1.53</span>), <span class="fu">complex</span>(<span class="at">real =</span> <span class="fu">sqrt</span>(<span class="fl">1.53</span>), <span class="at">imaginary =</span> <span class="dv">0</span>))</span>
<span id="cb12-3"><a href="testing.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">general_sqrt</span>(<span class="sc">-</span><span class="dv">2</span>), <span class="fu">complex</span>(<span class="at">real =</span> <span class="dv">0</span>, <span class="at">imaginary =</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)))</span>
<span id="cb12-4"><a href="testing.html#cb12-4" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><strong>Second</strong>, it’s important to remember that coverage is only important because tests with high coverage tend to test all the different functionalities of a package. It’s possible to have tests which have very high coverage but aren’t great tests. Consider the following example.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="testing.html#cb13-1" aria-hidden="true" tabindex="-1"></a>print_it <span class="ot">&lt;-</span> <span class="cf">function</span>(text){</span>
<span id="cb13-2"><a href="testing.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;hello&#39;</span>)</span>
<span id="cb13-3"><a href="testing.html#cb13-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-4"><a href="testing.html#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="testing.html#cb13-5" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<span class="fu">print_it</span>(<span class="st">&#39;hi&#39;</span>), <span class="cn">NA</span>)</span></code></pre></div>
<pre><code>## [1] &quot;hello&quot;</code></pre>
<p>This expectation has 100% coverage because it will run every line of code (the expectation will also pass because no warning will be thrown). However, it’s not sufficient alone because it doesn’t actually test whether print_it returns the desired output: in this case, print_it will always print ‘hello’. In other words, the expectation does not test all of the functionality of the function.</p>
<p><strong>Third</strong>, tests should run relatively quickly, if possible. Sometimes, it’s okay to maximize coverage even if you don’t test every single functionality to save time, because <em>usually</em> high coverage ensures you test most of the functionality of the package. This is particularly true because lots of integrated testing software (which we’ll discuss in integrated tests) will not be able to easily run tests which take too long. More on that later.</p>
<p><strong>Fourth</strong>, tests should be clear to the reader, because sometimes there are bugs in tests too. If others eventually help develop or maintain your packages, they’ll want to know what it means when a test fails. Moreover, for large packages, you yourself may have trouble remembering the exact details of every test you’ve written. Thus, your tests should return clear error messages and be readable. For example, the following test is a bad example, for two reasons:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="testing.html#cb15-1" aria-hidden="true" tabindex="-1"></a>sigmoid <span class="ot">&lt;-</span> <span class="cf">function</span>(x, a, b){</span>
<span id="cb15-2"><a href="testing.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(a<span class="sc">*</span>x)<span class="sc">/</span>(<span class="fu">exp</span>(a<span class="sc">*</span>x) <span class="sc">+</span> b))</span>
<span id="cb15-3"><a href="testing.html#cb15-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-4"><a href="testing.html#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="testing.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&#39;sigmoid output&#39;</span>, {</span>
<span id="cb15-6"><a href="testing.html#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">sigmoid</span>(<span class="fl">0.3068528</span>, <span class="dv">1</span>, <span class="fl">1.3591409</span>), <span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^-</span><span class="dv">7</span>)</span>
<span id="cb15-7"><a href="testing.html#cb15-7" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>The string ‘sigmoid output’ does not describe the purpose of the test, which is to test the precision of the sigmoid output. This means that if the test fails, it will be hard to tell what’s wrong. Additionally, the purpose of the test is not clear to begin with - what do the seemingly random decimals mean? At the very least, it’s probably worth putting comments in explaining the point of the test, as shown below.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="testing.html#cb16-1" aria-hidden="true" tabindex="-1"></a>sigmoid <span class="ot">&lt;-</span> <span class="cf">function</span>(x, a, b){</span>
<span id="cb16-2"><a href="testing.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(a<span class="sc">*</span>x)<span class="sc">/</span>(<span class="fu">exp</span>(a<span class="sc">*</span>x) <span class="sc">+</span> b))</span>
<span id="cb16-3"><a href="testing.html#cb16-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-4"><a href="testing.html#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="testing.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&#39;test sigmoid precision&#39;</span>, {</span>
<span id="cb16-6"><a href="testing.html#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="testing.html#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check sigmoid(ln(e/2), ln(e/2), e/2) is very close to 1/2.</span></span>
<span id="cb16-8"><a href="testing.html#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="testing.html#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">sigmoid</span>(<span class="fl">0.3068528</span>, <span class="dv">1</span>, <span class="fl">1.3591409</span>), <span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^-</span><span class="dv">7</span>)</span>
<span id="cb16-10"><a href="testing.html#cb16-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>This test is a bit more interpretable/readable and delivers a better error message.</p>
</div>
<div id="automated-checking" class="section level3" number="2.2.5">
<h3><span class="header-section-number">2.2.5</span> Automated Checking</h3>
<p>The <code>usethis::test()</code> function is pretty nice, but all it does is run your unit tests - it doesn’t check everything else in your package. Thankfully, the <code>devtools::check()</code> function fills this gap.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="testing.html#cb17-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">check</span>()</span></code></pre></div>
<p>Running the check function will ensure your documentation is up to date, automatically run all of your unit tests, and even check your code for common problems. It will also create a new directory called ‘Man’ within your package folder, which will later be populated with the help files for your functions. Note that even if your package passes all of its tests, you might still see additional warnings for other reasons, as exemplified below:</p>
<p><img src="images/testSS/autobuildresults.PNG" /></p>
<p>Although it’s not necessary to understand every check that the check function runs, it’s worth noting that every check it performs is relatively important, and if it signals any warnings or errors, it’s definitely worth fixing them. It’s also probably worth fixing any “notes” it issues. If you’re curious, you can read more about what each type of check in the automated check does <a href="http://r-pkgs.had.co.nz/check.html#check">here</a>.</p>
</div>
<div id="bonus-the-goodpractice-package" class="section level3" number="2.2.6">
<h3><span class="header-section-number">2.2.6</span> Bonus: The goodpractice Package</h3>
<p>The aforementioned automated checking system for R is pretty good, but there is a slightly more comprehensive version: the <a href="https://github.com/MangoTheCat/goodpractice/blob/master/vignettes/goodpractice.Rmd">goodpractice package</a>. The <code>goodpractice</code> package has an informative name - the entire purpose of the package is to check whether your package follows proper package development conventions and procedures (i.e. whether your package follows good practices). For example, running the <code>goodpractice</code> package on the <code>devex</code> package yielded the following helpful results:</p>
<p><img src="images/testSS/goodpractice1.PNG" /></p>
<p>Let’s run through the key points of using <code>goodpractice</code> below.</p>
<p>To install the goodpractice package, just run the following command in the R console:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="testing.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;goodpractice&#39;</span>)</span></code></pre></div>
<p>Once you’ve installed the <code>goodpractice</code> package, you basically only need to use a single function from it: the <code>gp()</code> or <code>goodpractice()</code> function (which call the same code). This function will run comprehensive automated checks on your package, and it takes exactly one input, the path of your built package. However, it’s important to note that the path of your <em>built</em> package is not identical to the path of the repo containing it. For example, I work on the <code>devex</code> package in “/Users/name/Documents/R/packageguidelines/devex”, but the built package lives at another location. For <code>goodpractice()</code> to work, you need to use this latter path. If you don’t know what the path is, you can use the “system.file” function to retrieve it for you, as demonstrated below.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="testing.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve path</span></span>
<span id="cb19-2"><a href="testing.html#cb19-2" aria-hidden="true" tabindex="-1"></a>package_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="at">package =</span> <span class="st">&#39;devex&#39;</span>)</span>
<span id="cb19-3"><a href="testing.html#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="testing.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check package</span></span>
<span id="cb19-5"><a href="testing.html#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(goodpractice)</span>
<span id="cb19-6"><a href="testing.html#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gp</span>(package_path)</span></code></pre></div>
<p>And that’s it! The <code>goodpractice</code> package is a bit picky, so it’s okay to leave a few concerns unresolved, but in general it gives good advice. If you’re diligent, you might eventually see a result like this:</p>
<p><img src="images/testSS/goodpractice2.PNG" /></p>
<p>which signals that your package conforms to all good practices. Lastly, although it’s beyond the scope of this guide, you ought to know that you can create custom checks using the <code>goodpractice</code> package, as documented <a href="https://github.com/MangoTheCat/goodpractice/blob/master/vignettes/custom_checks.Rmd">here</a>.</p>
<p>[up to here 2022]</p>
</div>
<div id="tips-and-tricks" class="section level3" number="2.2.7">
<h3><span class="header-section-number">2.2.7</span> Tips and Tricks</h3>
<p>When testing, there are a couple of key principles to keep in mind:</p>
<ol style="list-style-type: decimal">
<li>You want to expose bugs as quickly as possible so they don’t create even larger headaches down the road! As Christopher Gandrud puts it, testing is all about ‘failing faster.’ To this end, you should continuously test your packages.</li>
<li>Make sure your tests <em>cover</em> the package code and also test all of the key functionality of the package. In an ideal world, a package should pass all of its tests only if all of its core functionality is bug-free.</li>
<li>Test names, organization, and error messages must be descriptive and easy to understand. One of the main purposes of tests is to inform you <em>where</em> your code is failing, and to understand that, you need informative error messages. Otherwise, you will find yourself spending hours traversing your code to find bugs.</li>
</ol>
<p>The <code>devtools</code> cheatsheet, linked <a href="https://www.rstudio.com/wp-content/uploads/2015/03/devtools-cheatsheet.pdf">here</a>, references a lot of the key components of the <code>testthat</code> package.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="package-development.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="documentation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/the-Statistical-Support-Network/dss-rbuild/dss-rbuild/edit/main/02_testing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PFNZpackageDEV.pdf", "PFNZpackageDEV.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
