<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Package Development | Package Development in R for Predator Free New Zealand 2050</title>
  <meta name="description" content="This guide walks through the process of developing an R package" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Package Development | Package Development in R for Predator Free New Zealand 2050" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This guide walks through the process of developing an R package" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Package Development | Package Development in R for Predator Free New Zealand 2050" />
  
  <meta name="twitter:description" content="This guide walks through the process of developing an R package" />
  

<meta name="author" content="Anthony Davidson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="resources.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An R package development tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#table-of-contents"><i class="fa fa-check"></i>Table of Contents</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors-and-sources"><i class="fa fa-check"></i>Authors and Sources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="package-development.html"><a href="package-development.html"><i class="fa fa-check"></i><b>1</b> Package Development</a>
<ul>
<li class="chapter" data-level="1.1" data-path="package-development.html"><a href="package-development.html#downloading-development-tools"><i class="fa fa-check"></i><b>1.1</b> Downloading Development Tools</a></li>
<li class="chapter" data-level="1.2" data-path="package-development.html"><a href="package-development.html#initializing-the-package"><i class="fa fa-check"></i><b>1.2</b> Initializing the Package</a></li>
<li class="chapter" data-level="1.3" data-path="package-development.html"><a href="package-development.html#file-paths"><i class="fa fa-check"></i><b>1.3</b> File Paths</a></li>
<li class="chapter" data-level="1.4" data-path="package-development.html"><a href="package-development.html#the-description"><i class="fa fa-check"></i><b>1.4</b> The DESCRIPTION</a></li>
<li class="chapter" data-level="1.5" data-path="package-development.html"><a href="package-development.html#writing-code"><i class="fa fa-check"></i><b>1.5</b> Writing Code</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="package-development.html"><a href="package-development.html#general-coding-guidelines"><i class="fa fa-check"></i><b>1.5.1</b> General Coding Guidelines</a></li>
<li class="chapter" data-level="1.5.2" data-path="package-development.html"><a href="package-development.html#code-style"><i class="fa fa-check"></i><b>1.5.2</b> Code Style</a></li>
<li class="chapter" data-level="1.5.3" data-path="package-development.html"><a href="package-development.html#warnings-and-simplicity"><i class="fa fa-check"></i><b>1.5.3</b> Warnings and Simplicity</a></li>
<li class="chapter" data-level="1.5.4" data-path="package-development.html"><a href="package-development.html#loading-your-code"><i class="fa fa-check"></i><b>1.5.4</b> Loading Your Code</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="package-development.html"><a href="package-development.html#testing"><i class="fa fa-check"></i><b>1.6</b> Testing</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="package-development.html"><a href="package-development.html#why-should-you-test"><i class="fa fa-check"></i><b>1.6.1</b> Why should you test?</a></li>
<li class="chapter" data-level="1.6.2" data-path="package-development.html"><a href="package-development.html#what-are-unit-tests"><i class="fa fa-check"></i><b>1.6.2</b> What are unit tests?</a></li>
<li class="chapter" data-level="1.6.3" data-path="package-development.html"><a href="package-development.html#setting-up-the-testing-environment"><i class="fa fa-check"></i><b>1.6.3</b> Setting up the testing environment</a></li>
<li class="chapter" data-level="1.6.4" data-path="package-development.html"><a href="package-development.html#expectations"><i class="fa fa-check"></i><b>1.6.4</b> Expectations</a></li>
<li class="chapter" data-level="1.6.5" data-path="package-development.html"><a href="package-development.html#structure-and-location-of-unit-tests"><i class="fa fa-check"></i><b>1.6.5</b> Structure and Location of Unit Tests</a></li>
<li class="chapter" data-level="1.6.6" data-path="package-development.html"><a href="package-development.html#writing-good-tests"><i class="fa fa-check"></i><b>1.6.6</b> Writing Good Tests</a></li>
<li class="chapter" data-level="1.6.7" data-path="package-development.html"><a href="package-development.html#automated-checking"><i class="fa fa-check"></i><b>1.6.7</b> Automated Checking</a></li>
<li class="chapter" data-level="1.6.8" data-path="package-development.html"><a href="package-development.html#bonus-the-goodpractice-package"><i class="fa fa-check"></i><b>1.6.8</b> Bonus: The goodpractice Package</a></li>
<li class="chapter" data-level="1.6.9" data-path="package-development.html"><a href="package-development.html#tips-and-tricks"><i class="fa fa-check"></i><b>1.6.9</b> Tips and Tricks</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="package-development.html"><a href="package-development.html#documentation"><i class="fa fa-check"></i><b>1.7</b> Documentation</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="package-development.html"><a href="package-development.html#documenting-functions"><i class="fa fa-check"></i><b>1.7.1</b> Documenting Functions</a></li>
<li class="chapter" data-level="1.7.2" data-path="package-development.html"><a href="package-development.html#adding-a-readme"><i class="fa fa-check"></i><b>1.7.2</b> Adding a README</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="package-development.html"><a href="package-development.html#vignettes"><i class="fa fa-check"></i><b>1.8</b> Vignettes</a></li>
<li class="chapter" data-level="1.9" data-path="package-development.html"><a href="package-development.html#adding-and-documenting-data"><i class="fa fa-check"></i><b>1.9</b> Adding and Documenting Data</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="package-development.html"><a href="package-development.html#including-data-which-should-be-available-to-users"><i class="fa fa-check"></i><b>1.9.1</b> Including data which should be available to users</a></li>
<li class="chapter" data-level="1.9.2" data-path="package-development.html"><a href="package-development.html#including-data-for-your-functions"><i class="fa fa-check"></i><b>1.9.2</b> Including data for your functions</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="package-development.html"><a href="package-development.html#releasing-your-package"><i class="fa fa-check"></i><b>1.10</b> Releasing Your Package</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="package-development.html"><a href="package-development.html#pushing-to-github"><i class="fa fa-check"></i><b>1.10.1</b> Pushing to GitHub</a></li>
<li class="chapter" data-level="1.10.2" data-path="package-development.html"><a href="package-development.html#cran"><i class="fa fa-check"></i><b>1.10.2</b> CRAN</a></li>
<li class="chapter" data-level="1.10.3" data-path="package-development.html"><a href="package-development.html#publicizing"><i class="fa fa-check"></i><b>1.10.3</b> Publicizing</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="package-development.html"><a href="package-development.html#tips-and-tricks-1"><i class="fa fa-check"></i><b>1.11</b> Tips and Tricks</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>2</b> Resources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="resources.html"><a href="resources.html#general"><i class="fa fa-check"></i><b>2.1</b> General</a></li>
<li class="chapter" data-level="2.2" data-path="resources.html"><a href="resources.html#package-development-1"><i class="fa fa-check"></i><b>2.2</b> Package Development</a></li>
<li class="chapter" data-level="2.3" data-path="resources.html"><a href="resources.html#version-control"><i class="fa fa-check"></i><b>2.3</b> Version Control</a></li>
<li class="chapter" data-level="2.4" data-path="resources.html"><a href="resources.html#ides"><i class="fa fa-check"></i><b>2.4</b> IDEs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Package Development in R for Predator Free New Zealand 2050</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="package-development" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Package Development</h1>
<p>The following graphic outlines this entire chapter:</p>
<p><img src="images/package_workflow2.png" /></p>
<p>As a quick reminder, you can find the <code>devex</code> example package linked <a href="https://github.com/IQSS/Rbuild/tree/master/devex">here, on GitHub</a>, if you’d like to look through it while reading the guide.</p>
<div id="downloading-development-tools" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Downloading Development Tools</h2>
<p>There are a collection of development tools in R that make much of the package development cycle easier than ever before. Below are the list of packages needed to work with our development workflow.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="package-development.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;devtools&#39;</span>)</span></code></pre></div>
<pre><code>## Loading required package: usethis</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="package-development.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;usethis&#39;</span>)</span>
<span id="cb3-2"><a href="package-development.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;roxygen2&#39;</span>)</span>
<span id="cb3-3"><a href="package-development.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;testthat&#39;</span>)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;testthat&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:devtools&#39;:
## 
##     test_file</code></pre>
<p>Before we get started,</p>
<p>you’ll want to download four packages that are extremely useful for package development. For Mac/Linux users, head to the R Gui (or your favorite IDE) and run the code below to download the packages. If you are prompted to choose a CRAN mirror for your session, simply pick the mirror closest to your location.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="package-development.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb6-2"><a href="package-development.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;usethis&#39;</span>)</span>
<span id="cb6-3"><a href="package-development.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;roxygen2&#39;</span>)</span>
<span id="cb6-4"><a href="package-development.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;testthat&#39;</span>)</span></code></pre></div>
<p>If you are using Windows, prior to running the above code, you will need to install “RTools” by following these instructions:</p>
<ol style="list-style-type: decimal">
<li><p>Go to <a href="https://cran.rstudio.com/" class="uri">https://cran.rstudio.com/</a> and select “Download R for Windows.”</p></li>
<li><p>Click “RTools” and download the latest version of the tools (or the tools that are compatible with your version of R).</p></li>
<li><p>Let the installer run itself (the defaults are fine).</p></li>
</ol>
</div>
<div id="initializing-the-package" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Initializing the Package</h2>
<p>Now we can begin to walk through the process of creating an R package. The first thing you’ll always want to do is run the following function to initialize the package:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="package-development.html#cb7-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">create_package</span>(<span class="st">&#39;path/to/desired/location/packagename&#39;</span>)</span></code></pre></div>
<p>Note that the path specified by <code>usethis::create_package()</code> must currently be empty, otherwise <code>usethis</code> will throw an error. Successfully running this function will create a couple of important files which constitute a skeletal outline of the package. In particular, it will create:</p>
<ol style="list-style-type: decimal">
<li>An ‘R’ subdirectory in the root of your specified directory, which is where all of core the R code of your package will live.</li>
<li>A DESCRIPTION file, which will come with a couple of preset fields.</li>
<li>A NAMESPACE file.</li>
</ol>
<p>You can then set the working directory for your project to an “active” status:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="package-development.html#cb8-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">proj_set</span>(<span class="st">&#39;path/to/desired/location/packagename&#39;</span>)</span></code></pre></div>
<p>Once you’ve set up the basic structure of your package, you can start modifying files and writing it in earnest!</p>
</div>
<div id="file-paths" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> File Paths</h2>
<p>The paths used to locate files differ between UNIX (e.g., MacOS, Linux) and Windows based operating systems. Windows systems used a single backslash <code>\</code>, while UNIX systems use a single forward slash <code>/</code> to delimit files or directories in the path. R follows the UNIX convention of using forward slashes, but forces this on Window’s users too. So, file paths should look like this:</p>
<ol style="list-style-type: decimal">
<li>MacOS and Linux</li>
</ol>
<p><code>~/Documents/myproject/myRfile.R</code></p>
<ol start="2" style="list-style-type: decimal">
<li>Windows</li>
</ol>
<p><code>C:/Documents/myproject/myRfile.R</code></p>
<p>In the examples provided in this guide, we will show MacOS file paths. If you’re using Windows, you will need to modify these paths slightly to show the drive letter at the beginning, followed by a colon.</p>
</div>
<div id="the-description" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> The DESCRIPTION</h2>
<p>The DESCRIPTION file gives an extremely brief overview to the package. It includes critical information such as the author of the package, the title, a very short summary of its purpose, and the licensing information. Open the “DESCRIPTION” file using your favorite text editor in order to inspect and edit its contents.</p>
<p>DESCRIPTION is a DCF file (Debian control format). This file format may be unfamiliar, but it’s quite simple. Each line contains a field name and value, separated by a colon. Sometimes, values are long enough to require multiple lines, in which case they are indented by four spaces. For example, the DESCRIPTION file for a newly created package will look like this:</p>
<pre><code>
</code></pre>
<p><img src="images/packageSS/description_blank.png" /></p>
<p>Let’s go through the fields and discuss what they mean. The first seven fields listed are mandatory, meaning that if you do not include them, the development environment will throw an error later on when you’re trying to build your package.</p>
<ol style="list-style-type: decimal">
<li><strong>Package</strong>: This is the name of the package. It should match the package name you chose earlier, and you should probably just leave this as is.</li>
<li><strong>Title</strong>: A short but more descriptive title of your package than its name.</li>
<li><strong>Version</strong>: The version of your package. Since you’re creating this package for the first time, presumably it’s version 0.1.0.</li>
<li><strong>Authors</strong>: Here, you should add in your given and family names, role, email, and (optionally) your ORCID.</li>
<li><strong>Description</strong>: This should be a one-paragraph <em>comprehensive</em> description of the package. It is necessarily a high level-description, but it should be a complete one.</li>
<li><strong>License</strong>: You should add in a License, which describes how others can legally use the package. Most of the time (especially in the US), you should write ‘CC0’ in the License field, which implies that the package is open for all use, and you have relinquished all your rights to it. For more information on various licensing options, click <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Licensing">this link</a>.</li>
<li><strong>Encoding</strong>: Just leave this as “UTF-8”; discussing what encodings are isn’t super important for this guide. If you’re dying to learn about encodings, visit <a href="https://www.w3.org/International/questions/qa-what-is-encoding">this webpage</a>.</li>
<li><strong>LazyData</strong>: Just leave this as ‘true’, which ensures that if you include any data with your package (which you frequently will), when another user loads your package, they won’t automatically load up the data, but will only load it if it becomes necessary during their use. This option reduces the amount of RAM users have to expend when loading packages, especially if you are planning to include a lot of data with your package.</li>
</ol>
<p>(Note all of the fields from this point on are optional, but encouraged!)</p>
<ol start="9" style="list-style-type: decimal">
<li><strong>Type</strong>: This describes what type of project you’re creating - in this case, because you’re creating a package, you should write “Package.”</li>
<li><strong>Date</strong>: The date, in YYYY-MM-DD fashion.</li>
<li><strong>RoxygenNote</strong>: Roxygen will automatically fill in the version of <code>Roxygen2</code> used to build the package in this field.</li>
</ol>
<p>(These fields are exceptionally important if you are building a package using tools from other packages)</p>
<ol start="12" style="list-style-type: decimal">
<li><strong>Imports</strong>: In this field, you should list the packages which your package needs to function. Each package should be indented by two spaces, separated by a comma, and given its own line. For example, a package which requires <code>ggplot2</code>, <code>nlme</code>, and <code>rpart</code> might have an ‘imports’ field which looks like this:</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="package-development.html#cb10-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;images/packageSS/imports.PNG&quot;</span>)</span></code></pre></div>
<p><img src="images/packageSS/imports.PNG" width="74" /></p>
<!-- ![](images/packageSS/imports.PNG)    -->
<ol start="13" style="list-style-type: decimal">
<li><strong>Suggests</strong>: Sometimes, your package will not really <em>require</em> the use of other packages, but it might offer a couple of extra wrappers/functions with those other packages. When those extra functions aren’t strictly necessary, it’s a good idea to have your package <em>suggest</em> imports. For example, a package which includes the following function should include <code>ggplot2</code> in the ‘suggests’ part of the description.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="package-development.html#cb11-1" aria-hidden="true" tabindex="-1"></a>scalep <span class="ot">&lt;-</span> <span class="cf">function</span>(d, <span class="at">x=</span><span class="dv">1</span>){</span>
<span id="cb11-2"><a href="package-development.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  ...</span>
<span id="cb11-3"><a href="package-development.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If ggplot2 is available, use its qplot function - else, use the default hist function</span></span>
<span id="cb11-4"><a href="package-development.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb11-5"><a href="package-development.html#cb11-5" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">qplot</span>(r, <span class="at">geom=</span><span class="st">&#39;histogram&#39;</span>)</span>
<span id="cb11-6"><a href="package-development.html#cb11-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-7"><a href="package-development.html#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(r)</span>
<span id="cb11-8"><a href="package-development.html#cb11-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-9"><a href="package-development.html#cb11-9" aria-hidden="true" tabindex="-1"></a>  ...</span>
<span id="cb11-10"><a href="package-development.html#cb11-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here, the function <code>requireNameSpace()</code> checks if <code>ggplot2</code> is available, and if not, the function uses the (slightly less pretty) default histogram function.</p>
<p>Once you know which packages to list in the ‘suggests’ section, you can list them exactly the same way you’d list functions in the ‘imports’ section: each package is indented by two spaces, separated by a comma, and gets its own line.</p>
<p>In general, it’s best to suggest functions instead of requiring them if you barely use them in your package. This will give users a bit more flexibility, because it won’t force them to download packages they will probably never use.</p>
</div>
<div id="writing-code" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Writing Code</h2>
<div id="general-coding-guidelines" class="section level3" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> General Coding Guidelines</h3>
<p>All of your code should be in scripts in the ‘R’ file created in the package development environment, as shown below:</p>
<p><img src="images/packageSS/code1.PNG" /></p>
<p>The coding you will do in package development is slightly different than the coding you’ll normally do when writing R scripts. This is for a couple of reasons:</p>
<ol style="list-style-type: decimal">
<li>When you write a script and load that script using <code>source("script_name")</code>, the code in the script runs when you load it (specifically, when you run the <code>source()</code> command). On the other hand, the code in a package is run when the package is <em>built</em> on your computer. As a result, your code should mostly be focused on building functions, as opposed to a series of actions which the computer ought to take.</li>
<li>Unlike your personal scripts, other people will be using your package, and if your package is good, they’ll be using it in ways you didn’t anticipate. This means you ought to really try to make sure your code is as general as possible and can support a variety of approaches and implementations.</li>
<li>Also, because other people will be using your package, you should avoid modifying the global environment with your package. This means avoiding using functions like <code>require()</code>, <code>library()</code>, or <code>source()</code>; instead, there are other alternatives which can accomplish the same goal without changing the global environment and potentially giving other users an unwanted surprise. For example, instead of using <code>library()</code> and <code>require()</code>, you should be listing your necessary imports in the DESCRIPTION file, as outlined above, and then R will make sure anyone who installs and loads your package also has any other packages your package depends on. The one catch is that you’ll now have to append <code>packagename::</code> in front of the imported functions you want to use, otherwise R won’t recognize them. For example, to use the <code>qplot()</code> function from the <code>ggplot2</code> package, the code should look like:</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="package-development.html#cb12-1" aria-hidden="true" tabindex="-1"></a> ...</span>
<span id="cb12-2"><a href="package-development.html#cb12-2" aria-hidden="true" tabindex="-1"></a>scalep <span class="ot">&lt;-</span> <span class="cf">function</span>(d, <span class="at">x=</span><span class="dv">1</span>){</span>
<span id="cb12-3"><a href="package-development.html#cb12-3" aria-hidden="true" tabindex="-1"></a> ...</span>
<span id="cb12-4"><a href="package-development.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">qplot</span>(r, <span class="at">geom=</span><span class="st">&#39;histogram&#39;</span>)</span>
<span id="cb12-5"><a href="package-development.html#cb12-5" aria-hidden="true" tabindex="-1"></a> ...</span>
<span id="cb12-6"><a href="package-development.html#cb12-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The last thing you should know is that if you want your package to plot things, you will have to surround the <code>plot()</code> commands with a <code>print()</code> statement, like this:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="package-development.html#cb13-1" aria-hidden="true" tabindex="-1"></a> ...</span>
<span id="cb13-2"><a href="package-development.html#cb13-2" aria-hidden="true" tabindex="-1"></a>scalep <span class="ot">&lt;-</span> <span class="cf">function</span>(d, <span class="at">x=</span><span class="dv">1</span>){</span>
<span id="cb13-3"><a href="package-development.html#cb13-3" aria-hidden="true" tabindex="-1"></a> ...</span>
<span id="cb13-4"><a href="package-development.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(ggplot2<span class="sc">::</span><span class="fu">qplot</span>(r, <span class="at">geom=</span><span class="st">&#39;histogram&#39;</span>))</span>
<span id="cb13-5"><a href="package-development.html#cb13-5" aria-hidden="true" tabindex="-1"></a> ...</span>
<span id="cb13-6"><a href="package-development.html#cb13-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>You should also take care to organize your functions properly. It’s probably a bad idea to stick them all into one script and title it “functions.” Instead, you should organize functions by their purposes - for example, a variety of loss functions might go into a single script. Of course, some very complicated functions might deserve their own script. The file names of the script should be descriptive - for example, a script of loss functions might be named “loss_functions.R”.</p>
</div>
<div id="code-style" class="section level3" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Code Style</h3>
<p>Now let’s talk about code style. These recommendations are shortened and adapted from <a href="http://r-pkgs.had.co.nz/r.html">Hadley Wickham’s book</a>, which in turn were adapted from Google’s style guide.</p>
<ol style="list-style-type: decimal">
<li><strong>Comments</strong>: Comments are the best way to make your code readable. In general, you should err on the side of commenting too much rather than too little, and your comments should explain the <em>motivation</em> of your code as opposed to what your code actually does (although admittedly the line between those two things is a bit blurry). Moreover, you can use lines of ‘# —————————’ or ‘# ==================’ to separate sections of your code. Here are some examples:</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="package-development.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns the squared element-wise difference between two vectors</span></span>
<span id="cb14-2"><a href="package-development.html#cb14-2" aria-hidden="true" tabindex="-1"></a>loss <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb14-3"><a href="package-development.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  error <span class="ot">&lt;-</span> (x<span class="sc">-</span>y)<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb14-4"><a href="package-development.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(error)</span>
<span id="cb14-5"><a href="package-development.html#cb14-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-6"><a href="package-development.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------------------------------------------------------</span></span>
<span id="cb14-7"><a href="package-development.html#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="package-development.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Takes the square root of any real number, returning a complex number</span></span>
<span id="cb14-9"><a href="package-development.html#cb14-9" aria-hidden="true" tabindex="-1"></a>general_sqrt <span class="ot">&lt;-</span> <span class="cf">function</span> (x) {</span>
<span id="cb14-10"><a href="package-development.html#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the normal square root if x &gt; 0</span></span>
<span id="cb14-11"><a href="package-development.html#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">||</span> x <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb14-12"><a href="package-development.html#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">complex</span>(<span class="at">real=</span><span class="fu">sqrt</span>(x), <span class="at">imaginary=</span><span class="dv">0</span>))</span>
<span id="cb14-13"><a href="package-development.html#cb14-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-14"><a href="package-development.html#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Else return the complex square root</span></span>
<span id="cb14-15"><a href="package-development.html#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb14-16"><a href="package-development.html#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">complex</span>(<span class="at">real =</span> <span class="dv">0</span>, <span class="at">imaginary =</span> <span class="fu">sqrt</span>(<span class="sc">-</span>x)))</span>
<span id="cb14-17"><a href="package-development.html#cb14-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-18"><a href="package-development.html#cb14-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><strong>Names</strong>: Variable and function names should be descriptive but concise, and variable names should generally be nouns whereas function names tend to be verbs. Most R developers keep their function/variable names all lowercase and separate multiple words with underscores. There are no strict rules on this, but it’s nice to be consistent with <em>some</em> rules because it makes your code readable.</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="package-development.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad example - function name</span></span>
<span id="cb15-2"><a href="package-development.html#cb15-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb15-3"><a href="package-development.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(x))</span>
<span id="cb15-4"><a href="package-development.html#cb15-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-5"><a href="package-development.html#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="package-development.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Good example - function name</span></span>
<span id="cb15-7"><a href="package-development.html#cb15-7" aria-hidden="true" tabindex="-1"></a>take_sqrt <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb15-8"><a href="package-development.html#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(x))</span>
<span id="cb15-9"><a href="package-development.html#cb15-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-10"><a href="package-development.html#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="package-development.html#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad example - variable name</span></span>
<span id="cb15-12"><a href="package-development.html#cb15-12" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">read.table</span>(path)</span>
<span id="cb15-13"><a href="package-development.html#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="package-development.html#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Good example - variable name</span></span>
<span id="cb15-15"><a href="package-development.html#cb15-15" aria-hidden="true" tabindex="-1"></a>car_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(path)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><strong>Curly Braces</strong>: You should start a new line after you write an opening curly brace, and ending curly braces should get their own lines, unless you have an else clause or the line is exceptionally simple.</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="package-development.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad examples</span></span>
<span id="cb16-2"><a href="package-development.html#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="package-development.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (condition) {</span>
<span id="cb16-4"><a href="package-development.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complicated_function</span>(x)} <span class="co"># Ending curly brace should get a new line</span></span>
<span id="cb16-5"><a href="package-development.html#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="package-development.html#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Good examples</span></span>
<span id="cb16-7"><a href="package-development.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (condition) {<span class="fu">do</span>(x)} <span class="cf">else</span> {<span class="fu">do</span>(y)}</span>
<span id="cb16-8"><a href="package-development.html#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="package-development.html#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (condition) {</span>
<span id="cb16-10"><a href="package-development.html#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complicated_function_call</span>(arg1, arg2, arg3)</span>
<span id="cb16-11"><a href="package-development.html#cb16-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb16-12"><a href="package-development.html#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">other_complex_function_call</span>(arg7, arg3, arg5)</span>
<span id="cb16-13"><a href="package-development.html#cb16-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>As always, you can break the rules if you have a good reason to.</p>
<p>Different organizations and programmers may have different styles, but in general, you should remember:</p>
<ol style="list-style-type: decimal">
<li>Your goal should always be to make your code readable!</li>
<li>Whatever style guide you follow, follow it <em>consistently</em>.</li>
<li>When in doubt, follow the conventions of the organization you’re working for.</li>
</ol>
</div>
<div id="warnings-and-simplicity" class="section level3" number="1.5.3">
<h3><span class="header-section-number">1.5.3</span> Warnings and Simplicity</h3>
<p>Consider the case of the <code>scalep()</code> function, which currently takes a 2-column dataframe as an input, divides the second column by the first, and returns/graphs some scaled proportion of the quotient vector. One version of this function, which follows almost all of the guidelines above, might look like this:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="package-development.html#cb17-1" aria-hidden="true" tabindex="-1"></a>scalep <span class="ot">&lt;-</span> <span class="cf">function</span>(d, <span class="at">x=</span><span class="dv">1</span>){</span>
<span id="cb17-2"><a href="package-development.html#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="package-development.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intialize resulting vector</span></span>
<span id="cb17-4"><a href="package-development.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb17-5"><a href="package-development.html#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="package-development.html#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate through and divide column 2 of d by column 1 of d</span></span>
<span id="cb17-7"><a href="package-development.html#cb17-7" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-8"><a href="package-development.html#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(i <span class="sc">&lt;</span> <span class="fu">length</span>(d[ ,<span class="dv">1</span>]) <span class="sc">+</span> <span class="dv">1</span>){</span>
<span id="cb17-9"><a href="package-development.html#cb17-9" aria-hidden="true" tabindex="-1"></a>    row <span class="ot">&lt;-</span> d[i,]</span>
<span id="cb17-10"><a href="package-development.html#cb17-10" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">append</span>(result, row[[<span class="dv">2</span>]]<span class="sc">/</span>row[[<span class="dv">1</span>]])</span>
<span id="cb17-11"><a href="package-development.html#cb17-11" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-12"><a href="package-development.html#cb17-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-13"><a href="package-development.html#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="package-development.html#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the graph using either ggplot2 or the hist function</span></span>
<span id="cb17-15"><a href="package-development.html#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb17-16"><a href="package-development.html#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ggplot2<span class="sc">::</span><span class="fu">qplot</span>(result, <span class="at">geom=</span><span class="st">&#39;histogram&#39;</span>))</span>
<span id="cb17-17"><a href="package-development.html#cb17-17" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-18"><a href="package-development.html#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">hist</span>(result))</span>
<span id="cb17-19"><a href="package-development.html#cb17-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-20"><a href="package-development.html#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="package-development.html#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the result, multiplying by the optional scalar</span></span>
<span id="cb17-22"><a href="package-development.html#cb17-22" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> x<span class="sc">*</span>result</span>
<span id="cb17-23"><a href="package-development.html#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb17-24"><a href="package-development.html#cb17-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>However, this function still has a couple of problems. It’s not super easy to use because (a) it’s understandably hard for other programmers to remember which column is divided by which and (b) there’s a simpler way to accomplish the code above which will make it more readable. Specifically, it might be easier to just have arguments called ‘factors’ and ‘divisors’ and then divide them, like this:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="package-development.html#cb18-1" aria-hidden="true" tabindex="-1"></a>scalep <span class="ot">&lt;-</span> <span class="cf">function</span>(factors, divisors, <span class="at">constant =</span> <span class="dv">1</span>) {</span>
<span id="cb18-2"><a href="package-development.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="package-development.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Divide and multiply by optional scalar</span></span>
<span id="cb18-4"><a href="package-development.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  proportions <span class="ot">&lt;-</span> constant<span class="sc">*</span>factors<span class="sc">/</span>divisors</span>
<span id="cb18-5"><a href="package-development.html#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="package-development.html#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the graph using either ggplot2 or the hist function</span></span>
<span id="cb18-7"><a href="package-development.html#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb18-8"><a href="package-development.html#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ggplot2<span class="sc">::</span><span class="fu">qplot</span>(proportions, <span class="at">geom=</span><span class="st">&#39;histogram&#39;</span>))</span>
<span id="cb18-9"><a href="package-development.html#cb18-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb18-10"><a href="package-development.html#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">hist</span>(proportions))</span>
<span id="cb18-11"><a href="package-development.html#cb18-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-12"><a href="package-development.html#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="package-development.html#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the result</span></span>
<span id="cb18-14"><a href="package-development.html#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(proportions)</span>
<span id="cb18-15"><a href="package-development.html#cb18-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The new argument structure will make it a bit easier to use. Similarly, the new structure simplifies the code, making it a bit more readable. However, it does pose one problem: whereas the previous structure mandated that the two vectors be the same length (because they were part of a dataframe), in this function, the two vectors might not be the same length and the function would not always throw an error (specifically, if ‘factors’ has a length which is is an integer multiple of the length of ‘divisors’, R will not warn the user at all). This problem is a type of <strong>silent error</strong> (silent errors are bugs which do not issue warnings or errors). Silent errors are terrible because they make bug-hunting extremely difficult: in large repositories of code, it becomes nearly impossible to find which specific line is causing problems without some kind of warning. Thus, it’s also worth adding in a couple of lines to warn the user if the factors and divisors are of different lengths, as is outlined below:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="package-development.html#cb19-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check divisors and factors are the same length</span></span>
<span id="cb19-2"><a href="package-development.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(divisors) <span class="sc">!=</span> <span class="fu">length</span>(factors)) {</span>
<span id="cb19-3"><a href="package-development.html#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">&#39;Length of divisors argument is not equal to length of factors argument&#39;</span>)</span>
<span id="cb19-4"><a href="package-development.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p>Lastly, it’s just worth adding an extra optional argument to let your users turn off the graphing feature of <code>scalep()</code>, just to make the function more useable, as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="package-development.html#cb20-1" aria-hidden="true" tabindex="-1"></a>scalep <span class="ot">&lt;-</span> <span class="cf">function</span>(factors, divisors, <span class="at">constant =</span> <span class="dv">1</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb20-2"><a href="package-development.html#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="package-development.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  ...</span>
<span id="cb20-4"><a href="package-development.html#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="package-development.html#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If graph = True, print the graph using either ggplot2 or the hist function</span></span>
<span id="cb20-6"><a href="package-development.html#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="sc">&amp;</span> graph) {</span>
<span id="cb20-7"><a href="package-development.html#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ggplot2<span class="sc">::</span><span class="fu">qplot</span>(proportions, <span class="at">geom=</span><span class="st">&#39;histogram&#39;</span>))</span>
<span id="cb20-8"><a href="package-development.html#cb20-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (graph) {</span>
<span id="cb20-9"><a href="package-development.html#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">hist</span>(proportions))</span>
<span id="cb20-10"><a href="package-development.html#cb20-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-11"><a href="package-development.html#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="package-development.html#cb20-12" aria-hidden="true" tabindex="-1"></a>  ...</span></code></pre></div>
<p>To summarize, this subsection thus contained three core ideas: (1) make your code simple, (2) make it easy to use by labeling arguments, and (3) always avoid silent errors.</p>
</div>
<div id="loading-your-code" class="section level3" number="1.5.4">
<h3><span class="header-section-number">1.5.4</span> Loading Your Code</h3>
<p>If you’ve finished writing your code and want to play with it a little bit, you can use the following function:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="package-development.html#cb21-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>()</span></code></pre></div>
<p>which (according to its documentation) “roughly simulates what happens when a package is installed and loaded with library.” As we’ll see in the <a href="package-development.html#releasing-your-package">build</a>, <a href="package-development.html#testing">testing</a>, and <a href="./integrated-development-environments.html#ex-building-packages">RStudio</a> sections, there are better ways to simulate the user experience and test your code, but <code>load_all()</code> is often a useful intermediate step.</p>

</div>
</div>
<div id="testing" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Testing</h2>
<div id="why-should-you-test" class="section level3" number="1.6.1">
<h3><span class="header-section-number">1.6.1</span> Why should you test?</h3>
</div>
<div id="what-are-unit-tests" class="section level3" number="1.6.2">
<h3><span class="header-section-number">1.6.2</span> What are unit tests?</h3>
</div>
<div id="setting-up-the-testing-environment" class="section level3" number="1.6.3">
<h3><span class="header-section-number">1.6.3</span> Setting up the testing environment</h3>
</div>
<div id="expectations" class="section level3" number="1.6.4">
<h3><span class="header-section-number">1.6.4</span> Expectations</h3>
</div>
<div id="structure-and-location-of-unit-tests" class="section level3" number="1.6.5">
<h3><span class="header-section-number">1.6.5</span> Structure and Location of Unit Tests</h3>
</div>
<div id="writing-good-tests" class="section level3" number="1.6.6">
<h3><span class="header-section-number">1.6.6</span> Writing Good Tests</h3>
</div>
<div id="automated-checking" class="section level3" number="1.6.7">
<h3><span class="header-section-number">1.6.7</span> Automated Checking</h3>
</div>
<div id="bonus-the-goodpractice-package" class="section level3" number="1.6.8">
<h3><span class="header-section-number">1.6.8</span> Bonus: The goodpractice Package</h3>
</div>
<div id="tips-and-tricks" class="section level3" number="1.6.9">
<h3><span class="header-section-number">1.6.9</span> Tips and Tricks</h3>

</div>
</div>
<div id="documentation" class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> Documentation</h2>
<div id="documenting-functions" class="section level3" number="1.7.1">
<h3><span class="header-section-number">1.7.1</span> Documenting Functions</h3>
</div>
<div id="adding-a-readme" class="section level3" number="1.7.2">
<h3><span class="header-section-number">1.7.2</span> Adding a README</h3>
</div>
</div>
<div id="vignettes" class="section level2" number="1.8">
<h2><span class="header-section-number">1.8</span> Vignettes</h2>
</div>
<div id="adding-and-documenting-data" class="section level2" number="1.9">
<h2><span class="header-section-number">1.9</span> Adding and Documenting Data</h2>
<div id="including-data-which-should-be-available-to-users" class="section level3" number="1.9.1">
<h3><span class="header-section-number">1.9.1</span> Including data which should be available to users</h3>
</div>
<div id="including-data-for-your-functions" class="section level3" number="1.9.2">
<h3><span class="header-section-number">1.9.2</span> Including data for your functions</h3>
</div>
</div>
<div id="releasing-your-package" class="section level2" number="1.10">
<h2><span class="header-section-number">1.10</span> Releasing Your Package</h2>
<div id="pushing-to-github" class="section level3" number="1.10.1">
<h3><span class="header-section-number">1.10.1</span> Pushing to GitHub</h3>
</div>
<div id="cran" class="section level3" number="1.10.2">
<h3><span class="header-section-number">1.10.2</span> CRAN</h3>
<div id="optional-building-precompiled-binaries" class="section level4" number="1.10.2.1">
<h4><span class="header-section-number">1.10.2.1</span> Optional: Building precompiled binaries</h4>
</div>
</div>
<div id="publicizing" class="section level3" number="1.10.3">
<h3><span class="header-section-number">1.10.3</span> Publicizing</h3>
</div>
</div>
<div id="tips-and-tricks-1" class="section level2" number="1.11">
<h2><span class="header-section-number">1.11</span> Tips and Tricks</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="resources.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/the-Statistical-Support-Network/dss-rbuild/dss-rbuild/edit/main/01_package_development.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PFNZpackageDEV.pdf", "PFNZpackageDEV.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
